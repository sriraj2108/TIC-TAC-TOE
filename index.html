<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe (Smart AI)</title>
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #141E30, #243B55);
    color: #fff;
    text-align: center;
  }
  h1 {
    margin-top: 25px;
    font-size: 2.3em;
  }
  #modeSelect {
    margin-top: 20px;
  }
  button {
    background: #2563eb;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    margin: 10px;
    cursor: pointer;
    font-size: 1em;
    transition: 0.3s;
  }
  button:hover {
    background: #1d4ed8;
  }
  #board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-gap: 10px;
    justify-content: center;
    margin: 40px auto;
  }
  .cell {
    width: 100px;
    height: 100px;
    background: #1f2937;
    border-radius: 15px;
    font-size: 2.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.3s;
  }
  .cell:hover {
    background: #374151;
  }
  #status {
    font-size: 1.3em;
    margin-top: 15px;
  }
</style>
</head>
<body>

<h1>Tic Tac Toe</h1>

<div id="modeSelect">
  <button onclick="startGame('player')">Player vs Player</button>
  <button onclick="startGame('computer')">Player vs Computer</button>
</div>

<div id="board"></div>
<div id="status"></div>
<button id="reset" onclick="resetGame()" style="display:none;">Restart</button>

<script>
let board = ['', '', '', '', '', '', '', '', ''];
let curPlayer = 'X';
let gameMode = '';
let gameActive = false;

const winPatterns = [
  [0,1,2],[3,4,5],[6,7,8],
  [0,3,6],[1,4,7],[2,5,8],
  [0,4,8],[2,4,6]
];

const boardDiv = document.getElementById('board');
const statusDiv = document.getElementById('status');
const resetBtn = document.getElementById('reset');

function startGame(mode) {
  gameMode = mode;
  document.getElementById('modeSelect').style.display = 'none';
  resetBtn.style.display = 'inline-block';
  boardDiv.innerHTML = '';
  board = ['', '', '', '', '', '', '', '', ''];
  curPlayer = 'X';
  gameActive = true;
  statusDiv.textContent = "Player X's turn";

  for (let i = 0; i < 9; i++) {
    const cell = document.createElement('div');
    cell.classList.add('cell');
    cell.dataset.index = i;
    cell.addEventListener('click', handleClick);
    boardDiv.appendChild(cell);
  }
}

function handleClick(e) {
  const index = e.target.dataset.index;
  if (!gameActive || board[index] !== '') return;

  board[index] = curPlayer;
  e.target.textContent = curPlayer;

  if (checkWinner()) {
    statusDiv.textContent = (gameMode === 'computer' && curPlayer === 'O')
      ? 'Computer wins! üíª'
      : `Player ${curPlayer} wins! üéâ`;
    gameActive = false;
    return;
  }

  if (board.every(cell => cell !== '')) {
    statusDiv.textContent = "It's a draw! üòê";
    gameActive = false;
    return;
  }

  curPlayer = curPlayer === 'X' ? 'O' : 'X';
  statusDiv.textContent = (gameMode === 'computer' && curPlayer === 'O') ? "Computer's turn..." : `Player ${curPlayer}'s turn`;

  if (gameMode === 'computer' && curPlayer === 'O' && gameActive) {
    setTimeout(computerMove, 700);
  }
}

function checkWinner() {
  return winPatterns.some(pattern => {
    const [a,b,c] = pattern;
    return board[a] && board[a] === board[b] && board[b] === board[c];
  });
}

function tryMove(index, mark) {
  if (board[index] === '') {
    board[index] = mark;
    const isWin = checkWinner();
    board[index] = '';
    return isWin;
  }
  return false;
}

function computerMove() {
  let moveMade = false;

  // Try to win
  for (let i = 0; i < 9; i++) {
    if (tryMove(i, 'O')) {
      makeMove(i);
      statusDiv.textContent = "Computer chose a winning move üíª";
      moveMade = true;
      break;
    }
  }

  // Try to block
  if (!moveMade) {
    for (let i = 0; i < 9; i++) {
      if (tryMove(i, 'X')) {
        makeMove(i);
        statusDiv.textContent = "Computer blocked your move üòé";
        moveMade = true;
        break;
      }
    }
  }

  // Random move
  if (!moveMade) {
    let emptyCells = board.map((v, i) => v === '' ? i : null).filter(v => v !== null);
    let randomIndex = emptyCells[Math.floor(Math.random() * emptyCells.length)];
    makeMove(randomIndex);
    statusDiv.textContent = "Computer made a random move ü§ñ";
  }

  if (checkWinner()) {
    statusDiv.textContent = "Computer wins! üíª";
    gameActive = false;
    return;
  }

  if (board.every(cell => cell !== '')) {
    statusDiv.textContent = "It's a draw! üòê";
    gameActive = false;
    return;
  }

  curPlayer = 'X';
  statusDiv.textContent = "Your turn (X)";
}

function makeMove(index) {
  board[index] = 'O';
  document.querySelector(`[data-index='${index}']`).textContent = 'O';
}

function resetGame() {
  document.getElementById('modeSelect').style.display = 'block';
  boardDiv.innerHTML = '';
  statusDiv.textContent = '';
  resetBtn.style.display = 'none';
  gameActive = false;
}
</script>

</body>
</html>
